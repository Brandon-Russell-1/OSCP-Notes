<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Hashcat Cheat Sheet - Brandon&#x27;s OSCP Notes</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> The Things</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="Quick Notes.html"><strong aria-hidden="true">1.1.</strong> Quick Notes</a></li><li class="chapter-item expanded "><a href="Scanning.html"><strong aria-hidden="true">1.2.</strong> Scanning</a></li><li class="chapter-item expanded "><a href="File Transfer.html"><strong aria-hidden="true">1.3.</strong> File Transfer</a></li><li class="chapter-item expanded "><a href="Ports.html"><strong aria-hidden="true">1.4.</strong> Ports</a></li><li class="chapter-item expanded "><a href="Shells.html"><strong aria-hidden="true">1.5.</strong> Shells</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Gaining Access</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="CrackMapExecCheatSheet.html"><strong aria-hidden="true">2.1.</strong> CrackMapExec Cheat Sheet</a></li><li class="chapter-item expanded "><a href="Web Shells.html"><strong aria-hidden="true">2.2.</strong> Web Shells</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.</strong> Password Cracking</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="My Hashcat Cheatsheet.html" class="active"><strong aria-hidden="true">2.3.1.</strong> Hashcat Cheat Sheet</a></li><li class="chapter-item expanded "><a href="My Hydra Cheatsheet.html"><strong aria-hidden="true">2.3.2.</strong> Hydra Cheat Sheet</a></li><li class="chapter-item expanded "><a href="Bruteforce.html"><strong aria-hidden="true">2.3.3.</strong> Bruteforce</a></li></ol></li><li class="chapter-item expanded "><a href="Buffer Overflow.html"><strong aria-hidden="true">2.4.</strong> Buffer Overflow</a></li><li class="chapter-item expanded "><a href="File Uploads.html"><strong aria-hidden="true">2.5.</strong> File Uploads</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="htmlfileupload.html"><strong aria-hidden="true">2.5.1.</strong> HTML</a></li><li class="chapter-item expanded "><a href="MyMacros.html"><strong aria-hidden="true">2.5.2.</strong> Macro</a></li><li class="chapter-item expanded "><a href="OLEFileUpload.html"><strong aria-hidden="true">2.5.3.</strong> OLE</a></li></ol></li><li class="chapter-item expanded "><a href="LFIRFI.html"><strong aria-hidden="true">2.6.</strong> LFI/RFI</a></li><li class="chapter-item expanded "><a href="ShellShock.html"><strong aria-hidden="true">2.7.</strong> Shell Shock</a></li><li class="chapter-item expanded "><a href="Github.html"><strong aria-hidden="true">2.8.</strong> Github</a></li><li class="chapter-item expanded "><a href="MySQL.html"><strong aria-hidden="true">2.9.</strong> SQL</a></li><li class="chapter-item expanded "><a href="WindowLibraries.html"><strong aria-hidden="true">2.10.</strong> Windows Libraries and APIs</a></li><li class="chapter-item expanded "><a href="XXEXSSDeSerial.html"><strong aria-hidden="true">2.11.</strong> XXE_XSS_Deserialization</a></li><li class="chapter-item expanded "><a href="DirectoryTraveral.html"><strong aria-hidden="true">2.12.</strong> Directory Traversal</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Linux PrivEsc</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="LinuxEnum.html"><strong aria-hidden="true">3.1.</strong> Enumeration</a></li><li class="chapter-item expanded "><a href="LinuxPrivExploit.html"><strong aria-hidden="true">3.2.</strong> Exploit</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Windows PrivEsc</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="WinPrivEnum.html"><strong aria-hidden="true">4.1.</strong> Enumeration</a></li><li class="chapter-item expanded "><a href="WinPrivExploit.html"><strong aria-hidden="true">4.2.</strong> Exploit</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Active Directory</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="WeGotUsersbutnoPass.html"><strong aria-hidden="true">5.1.</strong> We got Users but no Pass?</a></li><li class="chapter-item expanded "><a href="ADEnum.html"><strong aria-hidden="true">5.2.</strong> Enumeration</a></li><li class="chapter-item expanded "><a href="ADAuth.html"><strong aria-hidden="true">5.3.</strong> Authentication</a></li><li class="chapter-item expanded "><a href="ADPivoting.html"><strong aria-hidden="true">5.4.</strong> Pivoting</a></li><li class="chapter-item expanded "><a href="ADLateralMovement.html"><strong aria-hidden="true">5.5.</strong> Lateral Movement</a></li><li class="chapter-item expanded "><a href="ADHashDump.html"><strong aria-hidden="true">5.6.</strong> Hash Dumping</a></li><li class="chapter-item expanded "><a href="ADPersistence.html"><strong aria-hidden="true">5.7.</strong> Persistence</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Brandon&#x27;s OSCP Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="hashcat-cheatsheet"><a class="header" href="#hashcat-cheatsheet">Hashcat-Cheatsheet</a></h1>
<p>Hashcat Cheatsheet for OSCP
https://hashcat.net/wiki/doku.php?id=hashcat</p>
<h2 id="identify-hashes"><a class="header" href="#identify-hashes">Identify Hashes</a></h2>
<p><code>hash-identifier</code></p>
<p>Example Hashes: https://hashcat.net/wiki/doku.php?id=example_hashes</p>
<h2 id="max-power"><a class="header" href="#max-power">MAX POWER!</a></h2>
<p>I have found that I can squeeze some more power out of my hash cracking by adding these parameters:</p>
<pre><code>--force -O -w 4 --opencl-device-types 1,2
</code></pre>
<p>These will force Hashcat to use the CUDA GPU interface which is buggy but provides more performance (–force) , will Optimize for 32 characters or less passwords (-O) and will set the workload to "Insane" (-w 4) which is supposed to make your computer effectively unusable during the cracking process.
Finally "--opencl-device-types 1,2 " will force HashCat to use BOTH the GPU and the CPU to handle the cracking.</p>
<h2 id="using-hashcat-and-a-dictionary"><a class="header" href="#using-hashcat-and-a-dictionary">Using hashcat and a dictionary</a></h2>
<p>Create a .hash file with all the hashes you want to crack puthasheshere.hash: $1$O3JMY.Tw$AdLnLjQ/5jXF9.MTp3gHv/</p>
<p>Hashcat example cracking Linux md5crypt passwords $1$ using rockyou:</p>
<p><code>hashcat --force -m 500 -a 0 -o found1.txt --remove puthasheshere.hash /usr/share/wordlists/rockyou.txt</code></p>
<p>Hashcat example cracking Wordpress passwords using rockyou:<br />
<code>hashcat --force -m 400 -a 0 -o found1.txt --remove wphash.hash /usr/share/wordlists/rockyou.txt</code></p>
<p>Sample Hashes
http://openwall.info/wiki/john/sample-hashes</p>
<h2 id="hashcat-one-rule-to-rule-them-all"><a class="header" href="#hashcat-one-rule-to-rule-them-all">HashCat One Rule to Rule them All</a></h2>
<p>Not So Secure has built a custom rule that I have had luck with in the past:<br />
https://www.notsosecure.com/one-rule-to-rule-them-all/<br />
The rule can be downloaded from their Github site:<br />
https://github.com/NotSoSecure/password_cracking_rules</p>
<p>I typically drop OneRuleToRuleThemAll.rule into the rules subfolder and run it like this from my windows box (based on the notsosecure article):</p>
<pre><code>hashcat64.exe --force -m300 --status -w3 -o found.txt --remove --potfile-disable -r rules\OneRuleToRuleThemAll.rule hash.txt rockyou.txt
</code></pre>
<h2 id="using-hashcat-bruteforcing"><a class="header" href="#using-hashcat-bruteforcing">Using hashcat bruteforcing</a></h2>
<pre><code>predefined charsets
?l = abcdefghijklmnopqrstuvwxyz
?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ
?d = 0123456789
?s = «space»!"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
?a = ?l?u?d?s
?b = 0x00 - 0xff
</code></pre>
<p>?l?d?u is the same as:<br />
?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</p>
<p>Brute force all passwords length 1-8 with possible characters A-Z a-z 0-9<br />
<code>hashcat64 -m 500 hashes.txt -a  3  ?1?1?1?1?1?1?1?1 --increment -1 ?l?d?u</code></p>
<h2 id="cracking-linux-hashes---etcshadow-file"><a class="header" href="#cracking-linux-hashes---etcshadow-file">Cracking Linux Hashes - /etc/shadow file</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th><th>Type</th></tr></thead><tbody>
<tr><td>500</td><td>md5crypt $1$, MD5(Unix)</td><td>Operating-Systems</td></tr>
<tr><td>200</td><td>bcrypt $2*$, Blowfish(Unix)</td><td>Operating-Systems</td></tr>
<tr><td>400</td><td>sha256crypt $5$, SHA256(Unix)</td><td>Operating-Systems</td></tr>
<tr><td>1800</td><td>sha512crypt $6$, SHA512(Unix)</td><td>Operating-Systems</td></tr>
</tbody></table>
</div>
<h2 id="cracking-windows-hashes"><a class="header" href="#cracking-windows-hashes">Cracking Windows Hashes</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th><th>Type</th></tr></thead><tbody>
<tr><td>3000</td><td>LM</td><td>Operating-Systems</td></tr>
<tr><td>1000</td><td>NTLM</td><td>Operating-Systems</td></tr>
</tbody></table>
</div>
<h2 id="cracking-common-application-hashes"><a class="header" href="#cracking-common-application-hashes">Cracking Common Application Hashes</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th><th>Type</th></tr></thead><tbody>
<tr><td>900</td><td>MD4</td><td>Raw Hash</td></tr>
<tr><td>0</td><td>MD5</td><td>Raw Hash</td></tr>
<tr><td>5100</td><td>Half MD5</td><td>Raw Hash</td></tr>
<tr><td>100</td><td>SHA1</td><td>Raw Hash</td></tr>
<tr><td>10800</td><td>SHA-384</td><td>Raw Hash</td></tr>
<tr><td>1400</td><td>SHA-256</td><td>Raw Hash</td></tr>
<tr><td>1700</td><td>SHA-512</td><td>Raw Hash</td></tr>
</tbody></table>
</div>
<h2 id="cracking-common-file-password-protections"><a class="header" href="#cracking-common-file-password-protections">Cracking Common File Password Protections</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th><th>Type</th></tr></thead><tbody>
<tr><td>11600</td><td>7-Zip</td><td>Archives</td></tr>
<tr><td>12500</td><td>RAR3-hp</td><td>Archives</td></tr>
<tr><td>13000</td><td>RAR5</td><td>Archives</td></tr>
<tr><td>13200</td><td>AxCrypt</td><td>Archives</td></tr>
<tr><td>13300</td><td>AxCrypt in-memory SHA1</td><td>Archives</td></tr>
<tr><td>13600</td><td>WinZip</td><td>Archives</td></tr>
<tr><td>9700</td><td>MS Office &lt;= 2003 $0/$1, MD5 + RC4</td><td>Documents</td></tr>
<tr><td>9710</td><td>MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #1</td><td>Documents</td></tr>
<tr><td>9720</td><td>MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #2</td><td>Documents</td></tr>
<tr><td>9800</td><td>MS Office &lt;= 2003 $3/$4, SHA1 + RC4</td><td>Documents</td></tr>
<tr><td>9810</td><td>MS Office &lt;= 2003 $3, SHA1 + RC4, collider #1</td><td>Documents</td></tr>
<tr><td>9820</td><td>MS Office &lt;= 2003 $3, SHA1 + RC4, collider #2</td><td>Documents</td></tr>
<tr><td>9400</td><td>MS Office 2007</td><td>Documents</td></tr>
<tr><td>9500</td><td>MS Office 2010</td><td>Documents</td></tr>
<tr><td>9600</td><td>MS Office 2013</td><td>Documents</td></tr>
<tr><td>10400</td><td>PDF 1.1 - 1.3 (Acrobat 2 - 4)</td><td>Documents</td></tr>
<tr><td>10410</td><td>PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1</td><td>Documents</td></tr>
<tr><td>10420</td><td>PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2</td><td>Documents</td></tr>
<tr><td>10500</td><td>PDF 1.4 - 1.6 (Acrobat 5 - 8)</td><td>Documents</td></tr>
<tr><td>10600</td><td>PDF 1.7 Level 3 (Acrobat 9)</td><td>Documents</td></tr>
<tr><td>10700</td><td>PDF 1.7 Level 8 (Acrobat 10 - 11)</td><td>Documents</td></tr>
<tr><td>16200</td><td>Apple Secure Notes</td><td>Documents</td></tr>
</tbody></table>
</div>
<h2 id="cracking-commmon-database-hash-formats"><a class="header" href="#cracking-commmon-database-hash-formats">Cracking Commmon Database Hash Formats</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th><th>Type</th><th>Example Hash</th></tr></thead><tbody>
<tr><td>12</td><td>PostgreSQL</td><td>Database Server</td><td>a6343a68d964ca596d9752250d54bb8a:postgres</td></tr>
<tr><td>131</td><td>MSSQL (2000)</td><td>Database Server</td><td>0x01002702560500000000000000000000000000000000000000008db43dd9b1972a636ad0c7d4b8c515cb8ce46578</td></tr>
<tr><td>132</td><td>MSSQL (2005)</td><td>Database Server</td><td>0x010018102152f8f28c8499d8ef263c53f8be369d799f931b2fbe</td></tr>
<tr><td>1731</td><td>MSSQL (2012, 2014)</td><td>Database Server</td><td>0x02000102030434ea1b17802fd95ea6316bd61d2c94622ca3812793e8fb1672487b5c904a45a31b2ab4a78890d563d2fcf5663e46fe797d71550494be50cf4915d3f4d55ec375</td></tr>
<tr><td>200</td><td>MySQL323</td><td>Database Server</td><td>7196759210defdc0</td></tr>
<tr><td>300</td><td>MySQL4.1/MySQL5</td><td>Database Server</td><td>fcf7c1b8749cf99d88e5f34271d636178fb5d130</td></tr>
<tr><td>3100</td><td>Oracle H: Type (Oracle 7+)</td><td>Database Server</td><td>7A963A529D2E3229:3682427524</td></tr>
<tr><td>112</td><td>Oracle S: Type (Oracle 11+)</td><td>Database Server</td><td>ac5f1e62d21fd0529428b84d42e8955b04966703:38445748184477378130</td></tr>
<tr><td>12300</td><td>Oracle T: Type (Oracle 12+)</td><td>Database Server</td><td>78281A9C0CF626BD05EFC4F41B515B61D6C4D95A250CD4A605CA0EF97168D670EBCB5673B6F5A2FB9CC4E0C0101E659C0C4E3B9B3BEDA846CD15508E88685A2334141655046766111066420254008225</td></tr>
<tr><td>8000</td><td>Sybase ASE</td><td>Database Server</td><td>0xc00778168388631428230545ed2c976790af96768afa0806fe6c0da3b28f3e132137eac56f9bad027ea2</td></tr>
</tbody></table>
</div>
<h2 id="cracking-ntlm-hashes"><a class="header" href="#cracking-ntlm-hashes">Cracking NTLM hashes</a></h2>
<p>After grabbing or dumping the NTDS.dit and SYSTEM registry hive or dumping LSASS memory from a Windows box, you will often end up with NTLM hashes.</p>
<div class="table-wrapper"><table><thead><tr><th>Path</th><th>Description</th></tr></thead><tbody>
<tr><td>C:\Windows\NTDS\ntds.dit</td><td>Active Directory database</td></tr>
<tr><td>C:\Windows\System32\config\SYSTEM</td><td>Registry hive containing the key used to encrypt hashes</td></tr>
</tbody></table>
</div>
<p>And using Impacket to dump the hashes</p>
<pre><code>impacket-secretsdump -system SYSTEM -ntds ntds.dit -hashes lmhash:nthash LOCAL -outputfile ntlm-extract
</code></pre>
<p>You can crack the NTLM hash dump usign the following hashcat syntax:</p>
<pre><code>hashcat64 -m 1000 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\hashsample.hash "d:\WORDLISTS\realuniq.lst" -r OneRuleToRuleThemAll.rule
</code></pre>
<p><em>Benchmark using a Nvidia 2060 GTX:</em>
Speed: 7000 MH/s
Recovery Rate: 12.47%
Elapsed Time: 2 Hours 35 Minutes</p>
<h2 id="cracking-hashes-from-kerboroasting---krb5tgs"><a class="header" href="#cracking-hashes-from-kerboroasting---krb5tgs">Cracking Hashes from Kerboroasting - KRB5TGS</a></h2>
<p>A service principal name (SPN) is a unique identifier of a service instance. SPNs are used by Kerberos authentication to associate a service instance with a service logon account. This allows a client application to request that the service authenticate an account even if the client does not have the account name.
KRB5TGS - Kerberoasting Service Accounts that use SPN Once you have identified a Kerberoastable service account (Bloodhound? Powershell Empire? - likely a MS SQL Server Service Account), any AD user can request a krb5tgs hash from it which can be used to crack the password.</p>
<p>Based on my benchmarking, KRB5TGS cracking is 28 times slower than NTLM.</p>
<p>Hashcat supports multiple versions of the KRB5TGS hash which can easily be identified by the number between the dollar signs in the hash itself.</p>
<ul>
<li>13100 - Type 23       - $krb5tgs$23$</li>
<li>19600 - Type 17       - $krb5tgs$17$</li>
<li>19700 - Type 18       - $krb5tgs$18$</li>
<li>18200 - ASREP Type 23 - $krb5asrep$23$</li>
</ul>
<p>KRB5TGS Type 23 - Crackstation humans only word list with OneRuleToRuleThemAll mutations rule list.</p>
<pre><code>hashcat64 -m 13100 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\krb5tgs.hash d:\WORDLISTS\realhuman_phill.txt -r OneRuleToRuleThemAll.rule	
</code></pre>
<p><em>Benchmark using a Nvidia 2060 GTX:</em>
Speed: 250 MH/s
Elapsed Time: 9 Minutes</p>
<h2 id="cracking-ntlmv2-hashes-from-a-packet-capture"><a class="header" href="#cracking-ntlmv2-hashes-from-a-packet-capture">Cracking NTLMv2 Hashes from a Packet Capture</a></h2>
<p>You may be asked to recover a password from an SMB authentication (NTLMv2) from a Packet Capture.
The following is a 9-step process for formatting the hash correctly to do this.
https://research.801labs.org/cracking-an-ntlmv2-hash/</p>
<h2 id="to-crack-linux-hashes-you-must-first-unshadow-them"><a class="header" href="#to-crack-linux-hashes-you-must-first-unshadow-them">To crack linux hashes you must first unshadow them</a></h2>
<p><code>unshadow passwd-file.txt shadow-file.txt</code></p>
<p><code>unshadow passwd-file.txt shadow-file.txt &gt; unshadowed.txt</code></p>
<h2 id="crack-a-zip-password"><a class="header" href="#crack-a-zip-password">Crack a zip password</a></h2>
<p><code>zip2john Zipfile.zip | cut -d ':' -f 2 &gt; hashes.txt</code><br />
<code>hashcat -a 0 -m 13600 hashes.txt /usr/share/wordlists/rockyou.txt</code></p>
<p>Hashcat appears to have issues with some zip hash formats generated from zip2john.  You can fix this by editing the zip hash contents to align with the example zip hash format found on the hash cat example page:
<code>$zip2$*0*3*0*b5d2b7bf57ad5e86a55c400509c672bd*d218*0**ca3d736d03a34165cfa9*$/zip2$</code></p>
<p>John seems to accept a wider range of zip formats for cracking.</p>
<h2 id="prince-password-generation"><a class="header" href="#prince-password-generation">PRINCE Password Generation</a></h2>
<p>PRINCE (PRobability INfinite Chained Elements) is a hashcat utility for randomly generating probable passwords:</p>
<pre><code>pp64.bin --pw-min=8 &lt; dict.txt | head -20 shuf dict.txt | pp64.bin --pw-min=8 | head -20
</code></pre>
<p>Reference:<br />
https://github.com/hashcat/princeprocessor</p>
<h2 id="purple-rain"><a class="header" href="#purple-rain">Purple Rain</a></h2>
<p>Purple Rain attack uses a combination of Prince, a dictionary and random Mutation rules to dynamicaly create infinite combinations of passwords.</p>
<pre><code>shuf dict.txt | pp64.bin --pw-min=8 | hashcat -a 0 -m #type -w 4 -O hashes.txt -g 300000
</code></pre>
<p>Reference:<br />
https://www.netmux.com/blog/purple-rain-attack</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Web Shells.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="My Hydra Cheatsheet.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Web Shells.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="My Hydra Cheatsheet.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
